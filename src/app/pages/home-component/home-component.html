<div class="dashboard-wrapper" *ngIf="userStats$ | async as userStats; else loadingState">
  
  <header class="dash-header">
    <div class="welcome-text">
      <h1>Hola, {{ userStats.username }} ðŸ‘‹</h1>
      <p>ContinÃºa tu aprendizaje donde lo dejaste.</p>
    </div>
    
    <div class="streak-badge">
      <span class="fire-icon">ðŸ”¥</span>
      <div class="streak-info">
        <span class="count">{{ userStats.studyStreak }} DÃ­as</span>
        <span class="label">Racha seguida</span>
      </div>
    </div>
  </header>

  <div class="dash-grid">
    
    <section class="main-column">
      
      <div class="card resume-card" *ngIf="userStats.lastAccessed">
        <div class="card-content">
          <span class="tag">En curso</span>
          <h2>Problema: {{ userStats.lastAccessed.title }}</h2>
          <p class="topic-ref">Tema: {{ userStats.lastAccessed.topicName }}</p>
          
          <div class="progress-mini">
            <div class="bar" [style.width.%]="userStats.lastAccessed.progress"></div>
          </div>
        </div>
        
        <button class="btn-play" [routerLink]="['/solve', userStats.lastAccessed.exerciseId]">
          â–¶
        </button>
      </div>

      <div class="quick-actions">
        <div class="action-card" routerLink="/topics">
          <div class="icon-bg">ðŸ“š</div>
          <div class="action-text">
            <h3>Temario</h3>
            <p>Ver todos los mÃ³dulos</p>
          </div>
          <span class="arrow">â†’</span>
        </div>

        <div class="action-card" routerLink="/playground">
          <div class="icon-bg">ðŸ§ª</div>
          <div class="action-text">
            <h3>Playground</h3>
            <p>Modo libre</p>
          </div>
          <span class="arrow">â†’</span>
        </div>
      </div>
    </section>

    <section class="side-column">
      
      <div class="card stats-card">
        <div class="card-header">
          <h3>Mis Habilidades</h3>
          <a routerLink="/profile" class="link-small">Ver perfil</a>
        </div>
        
        <div class="skills-mini-list">
          <div class="skill-row" *ngFor="let skill of userStats.skills | slice:0:3">
            <span class="skill-name">{{ skill.name }}</span>
            <div class="skill-track">
              <div class="skill-fill" [style.width.%]="skill.progress"></div>
            </div>
          </div>
        </div>

        <div class="kpi-row">
          <div class="kpi">
            <strong>{{ userStats.exercisesCompleted }}</strong>
            <small>Resueltos</small>
          </div>
          <div class="vertical-line"></div>
          <div class="kpi">
            <strong>{{ userStats.totalHours }}h</strong>
            <small>PrÃ¡ctica</small>
          </div>
        </div>
      </div>

      <div class="card tip-card">
        <span class="tip-icon">ðŸ’¡</span>
        <p>{{ userStats.dailyTip }}</p>
      </div>

    </section>
  </div>
</div>

<ng-template #loadingState>
  <div class="loading-state">
    <p>Cargando tu perfil de aprendizaje...</p>
    </div>
</ng-template>