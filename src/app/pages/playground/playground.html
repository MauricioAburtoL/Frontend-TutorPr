<div class="main-layout">
  
  <header class="app-header">
    <div class="brand">
      <h1>Edu Assistant <span class="badge-beta">Beta</span></h1>
    </div>
    </header>

<ng-container *ngIf="currentExercise; else loading">
  <section class="problem-context">
    <div class="problem-header">
      <h2>
        <span class="icon">ğŸ“</span> {{ currentExercise.title }}
        <span class="difficulty-badge" 
              [class.easy]="currentExercise.difficulty === 'FÃ¡cil'"
              [class.medium]="currentExercise.difficulty === 'Medio'"
              [class.hard]="currentExercise.difficulty === 'DifÃ­cil'">
          {{ currentExercise.difficulty }}
        </span>
      </h2>
      <p>{{ currentExercise.description }}</p>
    </div>
  </section>
</ng-container>

<ng-template #loading>
  <section class="problem-context">
    <p>Cargando informaciÃ³n del ejercicio...</p>
  </section>
</ng-template>

  <div class="workspace">
    
    <section class="panel editor-panel">
      <div class="panel-toolbar">
        <span class="panel-label">Editor de CÃ³digo (Python)</span>
        <div class="actions">
          <button class="btn btn-sm btn-ghost" (click)="onHint()">ğŸ’¡ Pista</button>
          <button class="btn btn-sm btn-secondary" (click)="onCFG()">ğŸ”€ Ver Diagrama</button>
          <button class="btn btn-sm btn-primary" (click)="onRun()">â–¶ Ejecutar</button>
        </div>
      </div>

      <div class="editor-container">
        <app-code-editor
          [code]="code"
          (codeChange)="onCodeChange($event)">
        </app-code-editor>
      </div>

      <div class="console-wrapper">
        <app-output-console [execOut]="execOut"></app-output-console>
      </div>
      
      <app-hint-panel [hint]="hint" *ngIf="hint"></app-hint-panel>
    </section>

    <section class="panel visualization-panel">
      <div class="panel-header">
        <span class="panel-title">Diagrama de Flujo (CFG)</span>
        <small class="text-muted">Visualiza la lÃ³gica de tu cÃ³digo</small>
      </div>

      <div class="diagram-canvas">
        <div *ngIf="!mermaidSrc" class="empty-state-diagram">
          <span>ğŸ”€</span>
          <p>Presiona "Ver Diagrama" para generar la visualizaciÃ³n.</p>
        </div>
        <app-cfg-viewer [mermaidSrc]="mermaidSrc" *ngIf="mermaidSrc"></app-cfg-viewer>
      </div>
    </section>

  </div>
</div>